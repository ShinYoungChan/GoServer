<!--index.html-->

<!-- header.html 템플릿을 이 위치에 포함시킵니다. -->
{{ template "header.html" .}}
<!--
<div style="margin-bottom: 20px;">
  <a href="/article/create">
      <button type="button">새 게시글 작성하기</button>
  </a>
</div>
-->

<form action="/" method="GET">
    <input type="text" name="q" value="{{.query}}" placeholder="검색어를 입력하세요">
    <button type="submit">검색</button>
</form>

<ul>
  {{ range .articles }}
  <li>
      <a href="/article/view/{{.ID}}">{{.Title}}</a>
      <small style="color: gray;">({{.FormattedCreatedAt}})</small>
  </li>
  {{ end }}
</ul>

<style>
    .pagination a { text-decoration: none; color: black; margin: 0 5px; }
    .pagination .active { font-weight: bold; color: red; }
</style>

<div class="pagination">
    {{ if .hasPrev }}
        <a href="/?q={{.query}}&page={{.prevPage}}">[이전]</a>
    {{ end }}

    {{ range $i := .pageNums }}
        <a href="/?q={{$.query}}&page={{$i}}">[{{$i}}]</a>
    {{ end }}

    {{ if .hasNext }}
        <a href="/?q={{.query}}&page={{.nextPage}}">[다음]</a>
    {{ end }}
</div>

<div style="margin-top: 10px;">
    <input type="number" id="pageInput" min="1" max="{{.totalPages}}" value="{{.page}}" style="width: 50px;">
    <button type="button" onclick="goToPage()">이동</button>
</div>

<script>
function goToPage() {
    const page = document.getElementById('pageInput').value;
    const query = "{{.query}}"; // 현재 검색어 유지
    location.href = `/?q=${query}&page=${page}`;
}
</script>

{{ if .user }}
    <span>안녕하세요, <strong>{{ .user.Username }}</strong>님!</span>
    <a href="/logout">로그아웃</a>
{{ else }}
    <a href="/login">로그인</a>
    <a href="/register">회원가입</a>
{{ end }}

{{ if .user }}
    <a href="/article/create"><button>새 글 쓰기</button></a>
{{ end }}


<!-- footer.html 템플릿을 이 위치에 포함시킵니다 -->
{{ template "footer.html" .}}